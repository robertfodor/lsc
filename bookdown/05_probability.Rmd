# (PART\*) INFERENTIAL STATISTICS{-}

# Introduction to probability {#probability}

Up to this point in the book, we've discussed some critical ideas in experimental design and talked a little about how you can summarise a data set. To many people, this is all there is to statistics: it's about calculating averages, collecting all the numbers, drawing pictures, and putting them all in a report somewhere. Kind of like stamp collecting, but with numbers. However, statistics cover much more than that. Descriptive statistics is one of the less significant parts of statistics and one of the least powerful. The more valuable part of statistics is that it provides tools that let you make *inferences* about data. 

Once you start thinking about statistics in these terms -- that statistics are there to help us draw inferences from data -- you start seeing examples everywhere. For instance, here's a small extract from a newspaper article in the Sydney Morning Herald (30 Oct 2010):

> "I have a tough job," the Premier said in response to a poll which found her government is now the most unpopular Labor administration in polling history, with a primary vote of just 23 per cent.

This kind of remark is unremarkable in the papers or in everyday life, but let's consider what it entails. A polling company has conducted an extensive survey because they can afford it. Let's imagine that they called 1000 NSW voters at random, and 230 (23\%) of those claimed that they intended to vote for the ALP. For the 2010 Federal election, the Australian Electoral Commission reported 4,610,795 enrolled voters in NSW, so the opinions of the remaining 4,609,795 voters (about 99.98\% of voters) remain unknown to us. Even assuming that no one lied to the polling company, we can only say with 100\% confidence that the actual ALP primary vote is somewhere between 230/4610795 (about 0.005\%) and 4610025/4610795 (about 99.83\%). So, on what basis is it legitimate for the polling company, the newspaper, and the readership to conclude that the ALP primary vote is only about 23\%?

The answer to the question is pretty obvious: if we call 1000 people at random, and 230 of them say they intend to vote for the ALP, then it seems very unlikely that these are the *only* 230 people out of the entire voting public who actually intend to do so. In other words, we assume that the data collected by the polling company is pretty representative of the population at large. But how representative? Would we be surprised to discover that the true ALP primary vote is actually 24\%? 29\%? 37\%? At this point, everyday intuition starts to break down a bit. No one would be surprised by 24\%, and everybody would be surprised by 37\%, but it's hard to say whether 29\% is plausible. We need more powerful tools than just looking at the numbers and guessing.

**Inferential statistics** provides the tools we need to answer these questions. Since these questions lie at the heart of the scientific enterprise, they take up the lion's share of every introductory course on statistics and research methods. However, the theory of statistical inference is built on top of **probability theory**. And it is to probability theory that we must now turn. This discussion of probability theory is basically background: there's not a lot of statistics per se in this chapter, and you don't need to understand this material in as much depth as in the other chapters in this part of the book. Nevertheless, because probability theory does underpin so much of statistics, it's worth covering some of the basics. 

## How are probability and statistics different?{#probabilitystats}

Before discussing probability theory, it's helpful to consider the relationship between probability and statistics. The two disciplines are closely related, but they're not identical. Probability theory is "the doctrine of chances". It's a branch of mathematics that tells you how often different events will happen. For example, all of these questions are things you can answer using probability theory:

- What are the chances of a fair coin coming up heads 10 times in a row?
- If we roll two six-sided dice, how likely is it that we'll roll two sixes?
- How likely is it that five cards drawn from a perfectly shuffled deck will all be hearts?
- What are the chances that we'll win the lottery?

Notice that all of these questions have something in common. In each case the "truth of the world" is known, and my question relates to the "what kind of events" will happen. In the first question, we *know* that the coin is fair, so there's a 50\% chance that any individual coin flip will come up heads. In the second question, we *know* that the chance of rolling a 6 on a single die is 1 in 6. In the third question, we *know* that the deck is shuffled properly. And in the fourth question, we *know* that the lottery follows specific rules. You get the idea. The critical point is that probabilistic questions start with a known **_model_** of the world, and we use that model to do some calculations. The underlying model can be quite simple. For instance, in the coin flipping example, we can write down the model like this:
$$
P(\mbox{heads}) = 0.5
$$
which you can read as "the probability of heads is 0.5". As we'll see later, in the same way, percentages are numbers that range from 0\% to 100\%, and probabilities are just numbers that range from 0 to 1. When using this probability model to answer the first question, we don't know exactly what will happen. Maybe we'll get 10 heads like the question says. But perhaps we'll get three heads. That's the key thing: in probability theory, the *model* is known, but the *data* are not.

So that's probability. What about statistics? Statistical questions work the other way around. In statistics, we *do not* know the truth about the world. All we have is the data from which we want to *learn* the truth about the world. Statistical questions tend to look more like these:

- If a friend flips a coin 10 times and gets 10 heads, are they playing a trick?
- If five cards off the top of the deck are all hearts, how likely is it that the deck was shuffled? 
- If the lottery commissioner's spouse wins the lottery, how likely is it that the lottery was rigged?

This time around, the only thing we have are data. What we *know* is that we saw a friend flip the coin 10 times, and it came up heads every time. And what we want to **infer** is whether or not we should conclude that what we just saw was actually a fair coin being flipped 10 times in a row, or whether we should suspect that the friend is playing a trick on us. The data we have look like this:
```
H H H H H H H H H H H
```
and what we're trying to do is work out which "model of the world" we should put my trust in. If the coin is fair, then the model we should adopt is one that says that the probability of heads is 0.5; that is, $P(\mbox{heads}) = 0.5$. If the coin is not fair, then we should conclude that the probability of heads is *not* 0.5, which we would write as $P(\mbox{heads}) \neq 0.5$. In other words, the statistical inference problem is to figure out which of these probability models is right. Clearly, the statistical question isn't the same as the probability question, but they're deeply connected to one another. Because of this, a good introduction to statistical theory will start with a discussion of what probability is and how it works.

## What does probability mean?{#probabilitymeaning}

Let's start with the first of these questions. What is "probability"? It might seem surprising to you, but while statisticians and mathematicians (mostly) agree on what the *rules* of probability are, there's much less of a consensus on what the word really *means*. It seems weird because we're all very comfortable using words like "chance", "likely", "possible", and "probable", and it doesn't seem like it should be a complicated question to answer. If you had to explain "probability" to a five-year-old, you could do a pretty good job. But if you've ever had that experience in real life, you might walk away from the conversation feeling like you didn't quite get it right and that (like many everyday concepts) it turns out that you don't *really* know what it's all about. 

Let's suppose we want to bet on a soccer game between two teams of robots, *Arduino Arsenal* and *C Milan*. After thinking about it, we decide that there is an 80\% probability that *Arduino Arsenal* winning. What do we mean by that? Here are three possibilities:

- They're robot teams, so we can make them play over and over again, and if we did that, *Arduino Arsenal* would win 8 out of every 10 games on average.
- For any given game, we would only agree that betting on this game is only "fair" if a \$1 bet on *C Milan* gives a \$5 payoff (i.e. we get \$1 back plus a \$4 reward for being correct), as would a \$4 bet on *Arduino Arsenal* (i.e., \$4 bet plus a \$1 reward). 
- Our subjective "belief" or "confidence" in an *Arduino Arsenal* victory is four times as strong as our belief in a *C Milan* victory.

Each of these seems sensible. However, they're not identical, and not every statistician would endorse all of them. The reason is that there are different statistical ideologies (yes, really!) and depending on which one you subscribe to, you might say that some of those statements are meaningless or irrelevant. In this section, we give a brief introduction to the two main approaches that exist in the literature. These are by no means the only approaches, but they're the two big ones.


### The frequentist view

The first of the two major approaches to probability, and the more dominant one in statistics, is referred to as the **_frequentist view_**, which defines probability as a **_long-run frequency_**. Suppose we were to try flipping a fair coin over and over again. By definition, this is a coin that has $P(H) = 0.5$. What might we observe? One possibility is that the first 20 flips might look like this:
```
T,H,H,H,H,T,T,H,H,H,H,T,H,H,T,T,T,T,T,H
```
In this case, 11 of these 20 coin flips (55\%) came up heads. Now suppose that we'd been keeping a running tally of the number of heads (which we'll call $N_H$) that we've seen, across the first $N$ flips, and calculate the proportion of heads $N_H / N$ every time. Here's what we'd get:


```{r echo=FALSE}
knitr::kable(data.frame(stringsAsFactors=FALSE,
`number of flips` = c(1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 10, 11 , 12 , 13 , 14 , 15 , 16 , 17 , 18 , 19 , 20),
`number of heads` = c( 0 , 1 , 2 , 3 , 4 , 4 , 4 , 5 , 6 , 7,  8  ,  8 ,  9 , 10 , 10 , 10 , 10 , 10 , 10 , 11 ), 
`proportion` = c( .00 , .50 , .67 , .75 , .80 , .67 , .57 , .63 , .67 , .70, .73 , .67 , .69 , .71 , .67 ,  .63 , .59 , .56 , .53 , .55)))
```

Notice that at the start of the sequence, the *proportion* of heads fluctuates wildly, starting at .00 and rising as high as .80. Later on, one gets the impression that it dampens out a bit, with more and more of the values actually being pretty close to the "right" answer of .50. This is the frequentist definition of probability in a nutshell: flip a fair coin over and over again, and as $N$ grows large (approaches infinity, denoted $N\rightarrow \infty$), the proportion of heads will converge to 50\%. There are some subtle technicalities that mathematicians care about, but qualitatively speaking, that's how the frequentists define probability. Unfortunately, we don't have an infinite number of coins, or the infinite patience required to flip a coin an infinite number of times. However, we do have a computer, and computers excel at mindless repetitive tasks. So let's ask a computer to simulate flipping a coin 1000 times, and then draw a picture of what happens to the proportion $N_H / N$ as $N$ increases.  The results are shown in Figure \@ref(fig:frequentistprobability). As you can see, the *proportion of observed heads* eventually stops fluctuating, and settles down; when it does, the number at which it finally settles is the true probability of heads.

```{r frequentistprobability, fig.cap="An illustration of how frequentist probability works. If you flip a fair coin over and over again, the proportion of heads that you've seen eventually settles down, and converges to the true probability of 0.5. Each panel shows four different simulated experiments: in each case, we pretend we flipped a coin 1000 times, and kept track of the proportion of flips that were heads as we went along. Although none of these sequences actually ended up with an exact value of .5, if we'd extended the experiment for an infinite number of coin flips they would have.", echo=FALSE}

emphCol <- rgb(0,0,1)
emphColLight <- rgb(.5,.5,1)
emphGrey <- grey(.5)

eps <- TRUE
colour <- TRUE

	width <- 12
	height <- 8

	def.par <- par(no.readonly = TRUE)
	layout( matrix(1:4,2,2) )
	for( i in 1:4 ) {
		
		X <- as.numeric( runif(1000) > .5 )
		X <- cumsum(X) / (1:1000)
		plot( 1:1000, X, type="l", ylim=c(.3,.7), col=ifelse(colour,emphCol,emphGrey),
			xlab = "Number of Flips", ylab = "Proportion of Heads", lwd=3
			) 
		abline(h=.5,lty=2,col=emphGrey,lwd=2)
		
	}
	par(def.par)#- reset to default

```


The frequentist definition of probability has some desirable characteristics. Firstly, it is objective: the probability of an event is *necessarily* grounded in the world. The only way that probability statements can make sense is if they refer to (a sequence of) events that occur in the physical universe.^[This doesn't mean that frequentists can't make hypothetical statements, of course; it's just that if you want to make a statement about probability, then it must be possible to redescribe that statement in terms of a sequence of potentially observable events, and the relative frequencies of different outcomes that appear within that sequence.] Secondly, it is unambiguous: any two people watching the same sequence of events unfold, trying to calculate the probability of an event, must inevitably come up with the same answer. However, it also has undesirable characteristics. Firstly, infinite sequences don't exist in the physical world. Suppose you picked up a coin from your pocket and started to flip it. Every time it lands, it impacts the ground. Each impact wears the coin down a bit; eventually, the coin will be destroyed. So, one might ask whether it really makes sense to pretend that an "infinite" sequence of coin flips is even a meaningful concept or an objective one. We can't say that an "infinite sequence" of events is a real thing in the physical universe because the physical universe doesn't allow infinite anything. More seriously, the frequentist definition has a narrow scope. There are many things out there that human beings are happy to assign a probability to in everyday language but cannot (even in theory) be mapped onto a hypothetical sequence of events. For instance, if a meteorologist comes on TV and says, "the probability of rain in Adelaide on 2 November 2048 is 60\%", we humans are happy to accept this. But it's not clear how to define this in frequentist terms. There's only one city of Adelaide, and only 2 November 2048. There's no infinite sequence of events here, just a once-off thing. Frequentist probability genuinely *forbids* us from making probability statements about a single event. From the frequentist perspective, it will either rain tomorrow or not; there is no "probability" that attaches to a single non-repeatable event. Now, it should be said that there are some very clever tricks that frequentists can use to get around this. One possibility is that what the meteorologist means is something like this: "There is a category of days for which we predict a 60\% chance of rain; if we look only across those days for which we make this prediction, then on 60\% of those days it will actually rain". It's very weird and counterintuitive to think of it this way, but you do see frequentists do this sometimes. And it *will* come up later in this book (see Section \@ref(ci)).

### The Bayesian view

The **Bayesian view** of probability is often called the *subjectivist view*, and it is a minority view among statisticians but one that has been steadily gaining traction for the last several decades. There are many flavours of Bayesianism, making it hard to say what "the" Bayesian view is. The most common way of thinking about subjective probability is to define the probability of an event as the **degree of belief** that an intelligent and rational agent assigns to the truth of that event. From that perspective, probabilities don't exist in the world but rather in the thoughts and assumptions of people and other intelligent beings.
However, for this approach to work, we need some way of operationalising the "degree of belief". One way you can do this is to formalise it in terms of "rational gambling", though there are many other ways. Suppose that we believe that there's a 60\% probability of rain tomorrow. If someone offers us a bet: if it rains tomorrow, then we win \$5, but if it doesn't rain, then we lose \$5. Clearly, from our perspective, this is a pretty good bet. On the other hand, if we think the probability of rain is only 40\%, then it's a bad bet. Thus, we can operationalise the notion of a "subjective probability" in terms of what bets we're willing to accept. 

What are the advantages and disadvantages of the Bayesian approach? The main advantage is that it allows you to assign probabilities to any event you want to. You don't need to be limited to those events that are repeatable. The main disadvantage (to many people) is that we can't be purely objective -- specifying a probability requires us to specify an entity with the relevant degree of belief. This entity might be a human, an alien, a robot, or even a statistician, but there has to be an intelligent agent out there that believes in things. To many people, this is uncomfortable: it seems to make probability arbitrary. While the Bayesian approach does require that the agent in question be rational (i.e., obey the rules of probability), it does allow everyone to have their own beliefs; I can believe the coin is fair, and you don't have to, even though we're both rational. The frequentist view doesn't allow any two observers to attribute different probabilities to the same event: when that happens, then at least one of them must be wrong. The Bayesian view does not prevent this from occurring. Two observers with different background knowledge can legitimately hold different beliefs about the same event. In short, where the frequentist view is sometimes considered to be too narrow (forbids lots of things that that we want to assign probabilities to), the Bayesian view is sometimes thought to be too broad (allows too many differences between observers).

### What's the difference? And who is right?

Now that you've seen these two views independently, it's useful to make sure you can compare them. Go back to the hypothetical robot soccer game at the start of the section. What would a frequentist and a Bayesian say about these three statements? Which statement would a frequentist say is the correct definition of probability? Which one would a Bayesian do? Would some of these statements be meaningless to a frequentist or a Bayesian? If you've understood the two perspectives, you should have some sense of how to answer those questions.

Okay, assuming you understand the difference, you might be wondering which of them is *right*? Honestly, we don't know that there is a right answer. As far as we can tell, there's nothing mathematically incorrect about the way frequentists think about sequences of events, and there's nothing mathematically incorrect about the way that Bayesians define the beliefs of a rational agent. In fact, when you dig down into the details, Bayesians and frequentists actually agree about a lot of things. Many frequentist methods lead to decisions that Bayesians agree a rational agent would make. Many Bayesian methods have very good frequentist properties. 

Consider Sir Ronald Fisher, one of the towering figures of 20th-century statistics and a vehement opponent of all things Bayesian, whose paper on the mathematical foundations of statistics referred to Bayesian probability as "an impenetrable jungle [that] arrests progress towards precision of statistical concepts" @Fisher1922b. Or the psychologist Paul Meehl, who suggests that relying on frequentist methods could turn you into "a potent but sterile intellectual rake who leaves in his merry path a long train of ravished maidens but no viable scientific offspring" @Meehl1967. The history of statistics, as you might gather, is not devoid of entertainment.

In any case, while Danielle personally prefers the Bayesian view, the majority of statistical analyses are based on the frequentist approach. My reasoning is pragmatic: the goal of this book is to cover roughly the same territory as a typical undergraduate stats class in psychology, and if you want to understand the statistical tools used by most psychologists, you'll need a good grasp of frequentist methods. We promise you that this isn't a wasted effort. Even if you end up wanting to switch to the Bayesian perspective, you really should read through at least one book on the "orthodox" frequentist view. Every now and then, we'll add some commentary from a Bayesian point of view, and we'll revisit the topic in more depth in Chapter \@ref(bayes). 
 
 
## Basic probability theory{#basicprobability}

Although there are ideological arguments between Bayesians and frequentists, it turns out that people mostly agree on the rules that probabilities should obey. There are lots of different ways of arriving at these rules. The most commonly used approach is based on the work of Andrey Kolmogorov, one of the great Soviet mathematicians of the 20th century. Without going into a lot of detail, we'll try to give you a sense of how it works.

### Introducing probability distributions

Let's assume we own five pairs of pants: three pairs of jeans, the bottom half of a suit, and a pair of tracksuit pants. Let's call them $X_1$, $X_2$, $X_3$, $X_4$ and $X_5$. Now, on any given day, we pick out exactly one pair of pants. If we were to describe this situation using the language of probability theory, we would refer to each pair of pants (i.e., each $X$) as an **elementary event**. The key characteristic of elementary events is that every time we make an observation (e.g., every time we put on a pair of pants), then the outcome will be one and only one of these events. As said, we only wear exactly one pair of pants, so it satisfies this constraint. Similarly, the set of all possible events is called a **sample space**.

Okay, now that we have a sample space (a wardrobe) built from lots of possible elementary events (pants), we want to assign a **probability** of one of these elementary events. For an event $X$, the probability of that event $P(X)$ is a number that lies between 0 and 1. The bigger the value of $P(X)$, the more likely the event will occur. So, for example, if $P(X) = 0$, it means the event $X$ is impossible (i.e., we never wear those pants). On the other hand, if $P(X) = 1$ it means that event $X$ is certain to occur (i.e., we always wear those pants). For probability values in the middle, it means that we sometimes wear those pants. For instance, if $P(X) = 0.5$, it means that we wear those pants half of the time. 

At this point, we're almost done. The last thing we need to recognise is that "something always happens". Every time we put on pants, we really do end up wearing pants (crazy, right?). What this somewhat trite statement means, in probabilistic terms, is that the probabilities of the elementary events need to add up to 1. This is known as the **law of total probability**. More importantly, if these requirements are satisfied, then we have a **probability distribution**. For example, this is an example of a probability distribution

```{r echo=FALSE}
knitr::kable(data.frame(stringsAsFactors=FALSE,
`Which pants` = c( "Label" , "Probability" ), 
`Blue jeans` = c( "$X_1$" , "$P(X_1) = .5$" ),
`Grey jeans` = c( "$X_2$ ", "$P(X_2) = .3$ "),
`Black jeans` = c( "$X_3$ ", "$P(X_3) = .1$" ),
`Black suit` = c( "$X_4$" , "$P(X_4) = 0$ "),
`Blue tracksuit` = c( "$X_5$ ", "$P(X_5) = .1$")))
```

Each of the events has a probability that lies between 0 and 1, and if we add up the probability of all events, they sum to 1. Awesome. We can even draw a nice bar graph (see Section \@ref(bargraph)) to visualise this distribution, as shown in Figure \@ref(fig:pantsprob). And at this point, we've all achieved something. You've learned what probability distribution is.

```{r pantsprob, fig.cap="A visual depiction of the \"pants\" probability distribution. There are five \"elementary events\", corresponding to the five pairs of pants. Each event has some probability of occurring: this probability is a number between 0 to 1. The sum of these probabilities is 1.", echo=FALSE}


probabilities <- c( .5, .3, .1, 0, .1)
 eventNames <- c( "Blue jeans", "Grey jeans", "Black jeans", 
 "Black suit", "Blue track" )
 
 # draw the plot
 barplot( 
 height= probabilities, 
 xlab = "Event",
 ylab = "Probability of event",
 names.arg = eventNames,
 density = 10,
 col = ifelse(colour,emphCol,emphGrey)
 )
```

The only other thing that needs pointing out is that probability theory allows you to talk about **non-elementary events** as well as elementary ones. The easiest way to illustrate the concept is with an example. In the pants example, it's legitimate to refer to the probability that we wear jeans. In this scenario, the "We wear jeans" event is said to have happened as long as the elementary event that actually did occur is one of the appropriate ones; in this case "blue jeans", "black jeans", or "grey jeans". In mathematical terms, we defined the "jeans" event $E$ to correspond to the set of elementary events $(X_1, X_2, X_3)$. If any of these elementary events occurs, then $E$ is also said to have occurred. Having decided to write down the definition of the $E$ this way, it's pretty straightforward to state what the probability $P(E)$ is: we just add everything up. In this particular case
$$
P(E) = P(X_1) + P(X_2) + P(X_3)
$$ 
and, since the probabilities of blue, grey and black jeans respectively are .5, .3 and .1, the probability that we wear jeans is equal to .9. 

At this point, you might be thinking that this is all terribly obvious and simple, and you'd be right. All we've done is wrap some basic mathematics around a few common sense intuitions. However, from these simple beginnings, it's possible to construct some extremely powerful mathematical tools. Without going into the details in this book, we list -- in Table \@ref(tab:probrules) -- some of the other rules that probabilities satisfy. These rules can be derived from the simple assumptions that we've outlined above.

```{r probrules, echo=FALSE}
knitr::kable(data.frame(stringsAsFactors=FALSE,
English = c("Not $A$", "$A$ or $B$", "$A$ and $B$"),
Notation = c("$P(\\neg A)$", "$P(A \\cup B)$", "$P(A \\cap B)$"),
NANA = c("=", "=", "="),
Formula = c("$1-P(A)$", "$P(A) + P(B) - P(A \\cap B)$", "$P(A|B) P(B)$")),caption = "Some basic rules that probabilities must satisfy. You don't really need to know these rules in order to understand the analyses that we'll talk about later in the book, but they are important if you want to understand probability theory a bit more deeply.")

```


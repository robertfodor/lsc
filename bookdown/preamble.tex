% Page
%\usepackage[a4paper,margin=1in,bindingoffset=0.5in,footskip=0.5in]{geometry}

% Don't hyphenate
\usepackage[none]{hyphenat}

% CS colors
\usepackage{xcolor}
\definecolor{CSblue}{HTML}{3960A5}
\definecolor{CSbluelight}{HTML}{4878CE}
\definecolor{CSgreen}{HTML}{008000}
\definecolor{capcol}{HTML}{087830}
\definecolor{chap}{HTML}{E03616}
\definecolor{calloutbackground}{HTML}{F2F3F4}
\definecolor{calloutborder}{HTML}{0096C8}

% Font
  
  %% Main serif fonts with math
    \usepackage{amsmath}
    \usepackage{fontspec}
    \defaultfontfeatures{Ligatures=TeX}
    \setmainfont{STIXTwoText}[ 
    Extension = {.otf}, 
    UprightFont = {*-Regular}, 
    ItalicFont = {*-Italic}, 
    BoldFont = {*-Bold}, 
    BoldItalicFont = {*-BoldItalic}
    ]
    \setmathfont{STIX Two Math}
    \setmathfont{STIX Two Math}[range={scr,bfscr}, StylisticSet=1]
    \usepackage{bm} 
 
    %% Sans serif font
    \usepackage[sfdefault]{sourcesanspro}


% Captions and subfigures
\usepackage{caption}
\captionsetup[figure]{width=0.8\linewidth}
\captionsetup[table]{width=0.8\linewidth}
\usepackage[labelfont={color=capcol,bf}]{caption}
\usepackage[font={small,sf}]{caption}
\usepackage{subfig}

\usepackage{array}

% Package to tweak width
\usepackage{varwidth}

% For positioning figures
\usepackage{wrapfig}
\usepackage{float}
\floatplacement{figure}{H}
\renewcommand{\topfraction}{.85}
\renewcommand{\bottomfraction}{.7}
\renewcommand{\textfraction}{.15}
\renewcommand{\floatpagefraction}{.66}
\setcounter{topnumber}{3}
\setcounter{bottomnumber}{3}
\setcounter{totalnumber}{4}

% Titles and chapters
\usepackage{sectsty}
\chaptertitlefont{\Huge\bfseries\sourcesanspro\color{chap}}
\chapternumberfont{\huge\bfseries\sourcesanspro\color{chap}}
\sectionfont{\normalfont\Large\bfseries\sourcesanspro}
\subsectionfont{\normalfont\large\bfseries\sourcesanspro}
\usepackage[nobottomtitles*]{titlesec}
\titlespacing\subsection{0pt}{12pt plus 4pt minus 2pt}{12pt plus 4pt minus 2pt}

% Adding a framed box around text
\usepackage[most]{tcolorbox}
\newtcolorbox{callout}[1][]{%
  colback=calloutbackground,
  colframe=calloutborder,
  boxrule=0pt,
  leftrule=0.3em,
  sharp corners,
  halign=left,
  parbox=false,
  toptitle = 0.5em,
  bottomtitle = 0.5em,
  fontupper=\sourcesanspro\small,
  breakable = false,
  enhanced,
  title={#1},
  fonttitle=\bfseries\sourcesanspro\normalsize,
}

\newif\ifhidecallouttitledivs

\ifhidecallouttitledivs
  \usepackage{environ}
  \NewEnviron{callouttitle}{}
  \let\callouttitle
  \let\endcallouttitle
\fi

% Formatting theorems
\usepackage{amsthm}


\newtheoremstyle{indenteddefinition}
  {} % Space above
  {} % Space below
  {} % Body font
  {3em} % Indent amount
  {\bfseries} % Theorem head font
  {.} % Punctuation after theorem head
  {.5em} % Space after theorem head
  {} % Theorem head spec (can be left empty, meaning `normal')

\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{lemma}{Lemma}[chapter]
\newtheorem{corollary}{Corollary}[chapter]
\newtheorem{proposition}{Proposition}[chapter]
\newtheorem{conjecture}{Conjecture}[chapter]
%%\theoremstyle{definition}
\theoremstyle{indenteddefinition}
\newtheorem{definition}{Definition}[chapter]
%%\theoremstyle{definition}
\theoremstyle{indenteddefinition}
\newtheorem{example}{Example}[chapter]
\theoremstyle{definition}
\newtheorem{exercise}{Exercise}[chapter]
\theoremstyle{definition}
\newtheorem{hypothesis}{Hypothesis}[chapter]
\theoremstyle{remark}
\newtheorem*{remark}{Remark}
\newtheorem*{solution}{Solution}


% Dependencies for merging with external cover page
\usepackage{pdfpages}
\let\oldmaketitle\maketitle
\AtBeginDocument{\let\maketitle\relax}
